<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bablu Prasad (23104917)">

<title>Assignment 3 _ Movehub City Rankings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment3_23174917_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment3_23174917_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment3_23174917_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment3_23174917_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment3_23174917_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment3_23174917_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment3_23174917_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment3_23174917_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment3_23174917_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment3_23174917_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Assignment3_23174917_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="Assignment3_23174917_files/libs/d3-3.3.8/d3.min.js"></script>
<script src="Assignment3_23174917_files/libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="Assignment3_23174917_files/libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="Assignment3_23174917_files/libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="Assignment3_23174917_files/libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="Assignment3_23174917_files/libs/chromatography-0.1/chromatography.js"></script>
<script src="Assignment3_23174917_files/libs/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script>
<script src="Assignment3_23174917_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="Assignment3_23174917_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="Assignment3_23174917_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="Assignment3_23174917_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="Assignment3_23174917_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="Assignment3_23174917_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="Assignment3_23174917_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="Assignment3_23174917_files/libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="Assignment3_23174917_files/libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="Assignment3_23174917_files/libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<link href="Assignment3_23174917_files/libs/leaflet-easybutton-1.3.1/easy-button.css" rel="stylesheet">
<script src="Assignment3_23174917_files/libs/leaflet-easybutton-1.3.1/easy-button.js"></script>
<script src="Assignment3_23174917_files/libs/leaflet-easybutton-1.3.1/EasyButton-binding.js"></script>
<link href="Assignment3_23174917_files/libs/fontawesome-4.7.0/font-awesome.min.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 3 _ Movehub City Rankings</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bablu Prasad (23104917) </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction:</h3>
<p>Move Hubb know that everyone has different reasons for moving. Thatâ€™s why they have ranked some of the worlds top cities in relation to key factors, like safety, property affordability and climate. Simply selecting the factors most important to you and they will show you the best cities for you to consider!</p>
<p>For more details visit here <a href="https://www.movehub.com/city-rankings/">Click here</a></p>
</section>
<section id="we-have-total-3-files-downloaded-from-kaggle" class="level3">
<h3 class="anchored" data-anchor-id="we-have-total-3-files-downloaded-from-kaggle">We have total 3 files downloaded from <a href="https://www.kaggle.com/datasets/blitzr/movehub-city-rankings">Kaggle</a> :</h3>
<ul>
<li><p>movehubqualityoflife.csv</p></li>
<li><p>movehubcostofliving.csv</p></li>
<li><p>cities.csv (merged LAT &amp; LONG from data got from -&gt; Downloadable Geographic Databases | Simplemaps.com)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>DiagrammeR<span class="sc">::</span><span class="fu">mermaid</span>(<span class="st">'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="st">%%{init: {"flowchart": {"htmlLabels": false}} }%%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">  graph BT</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">     B[&lt;b&gt;movehubcostofliving.csv&lt;/b&gt;] --&gt;|City| A(&lt;b&gt;Combined_data&lt;/b&gt; - contain details of all 3 datasets)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">    C[&lt;b&gt;movehubqualityoflife.csv&lt;/b&gt;] --&gt;|City| A</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">    D[&lt;b&gt;read.csv&lt;/b&gt;] --&gt;|City| A</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">    E[&lt;b&gt;worldcities.xlsx&lt;/b&gt;] --&gt;|City| D</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">   style A fill:#f9f,stroke:#333,stroke-width:2px,font-weight:bold,font-style:italic;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="DiagrammeR html-widget html-fill-item" id="htmlwidget-46198a4b43cdaf99b940" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-46198a4b43cdaf99b940">{"x":{"diagram":"\n%%{init: {\"flowchart\": {\"htmlLabels\": false}} }%%\n  graph BT\n     B[<b>movehubcostofliving.csv<\/b>] -->|City| A(<b>Combined_data<\/b> - contain details of all 3 datasets)\n    C[<b>movehubqualityoflife.csv<\/b>] -->|City| A\n    D[<b>read.csv<\/b>] -->|City| A\n    E[<b>worldcities.xlsx<\/b>] -->|City| D\n   \n   style A fill:#f9f,stroke:#333,stroke-width:2px,font-weight:bold,font-style:italic;\n"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="importing-important-libraries" class="level3">
<h3 class="anchored" data-anchor-id="importing-important-libraries">Importing important Libraries:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppress warnings for conflicts when loading libraries </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn.conflicts =</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries with conflicts suppressed </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({ </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse, <span class="at">exclude =</span> <span class="fu">c</span>(<span class="st">"annotate"</span>, <span class="st">"combine"</span>))  <span class="co"># For data manipulation and visualization</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(RColorBrewer)  <span class="co"># For color palettes</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tm)  <span class="co"># For text mining and preprocessing</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(wordcloud)  <span class="co"># For creating word clouds</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(gridExtra)  <span class="co"># For arranging plots</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(leaflet)  <span class="co"># For interactive maps</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(corrplot)  <span class="co"># For visualizing correlation matrices</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(caTools)  <span class="co"># For data splitting</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(DiagrammeR)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MASS, <span class="at">exclude =</span> <span class="fu">c</span>(<span class="st">"dplyr"</span>))  <span class="co"># For statistical functions</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>}) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4     âœ” readr     2.1.5
âœ” forcats   1.0.0     âœ” stringr   1.5.1
âœ” ggplot2   3.5.0     âœ” tibble    3.2.1
âœ” lubridate 1.9.3     âœ” tidyr     1.3.1
âœ” purrr     1.0.2     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
Loading required package: NLP


Attaching package: 'NLP'


The following object is masked from 'package:ggplot2':

    annotate



Attaching package: 'gridExtra'


The following object is masked from 'package:dplyr':

    combine


corrplot 0.92 loaded


Attaching package: 'MASS'


The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset options to default </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-all-3-datasets" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-all-3-datasets">Loading the all 3 datasets:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cost_of_living <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"E:</span><span class="sc">\\\\</span><span class="st">Assigment3</span><span class="sc">\\\\</span><span class="st">movehubcostofliving.csv"</span>) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>quality_of_life <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"E:</span><span class="sc">\\\\</span><span class="st">Assigment3</span><span class="sc">\\\\</span><span class="st">movehubqualityoflife.csv"</span>) </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"E:</span><span class="sc">\\\\</span><span class="st">Assigment3</span><span class="sc">\\\\</span><span class="st">cities.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataset-understanding" class="level3">
<h3 class="anchored" data-anchor-id="dataset-understanding">Dataset Understanding:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all dataframes </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cost_of_living)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       City Cappuccino Cinema  Wine Gasoline Avg.Rent Avg.Disposable.Income
1  Lausanne       3.15  12.59  8.40     1.32  1714.00               4266.11
2    Zurich       3.28  12.59  8.40     1.31  2378.61               4197.55
3    Geneva       2.80  12.94 10.49     1.28  2607.95               3917.72
4     Basel       3.50  11.89  7.35     1.25  1649.29               3847.76
5     Perth       2.87  11.43 10.08     0.97  2083.14               3358.55
6 Nashville       3.84  12.00 13.50     0.65  2257.14               3089.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(quality_of_life)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          City Movehub.Rating Purchase.Power Health.Care Pollution
1      Caracas          65.18          11.25       44.44     83.45
2 Johannesburg          84.08          53.99       59.98     47.39
3    Fortaleza          80.17          52.28       45.46     66.32
4  Saint Louis          85.25          80.40       77.29     31.33
5  Mexico City          75.07          24.28       61.76     18.95
6      Detroit          70.63          73.81       63.05     83.45
  Quality.of.Life Crime.Rating
1            8.61        85.70
2           51.26        83.93
3           36.68        78.65
4           87.51        78.13
5           27.91        77.86
6           50.99        76.69</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cities)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              City       Country     LAT      LONG
1          Oakland United States 37.7904 -122.2166
2         Oakville        Canada   43.45  -79.6833
3 Oaxaca de JuÃ¡rez        Mexico 17.0606  -96.7253
4       Oberhausen       Germany 51.4967    6.8706
5          Obihiro         Japan 42.9167     143.2
6          Obninsk        Russia 55.0931   36.6106</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking datatype </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Datatype of 'cost_of_living' dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Datatype of 'cost_of_living' dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(cost_of_living))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   216 obs. of  7 variables:
 $ City                 : chr  "Lausanne" "Zurich" "Geneva" "Basel" ...
 $ Cappuccino           : num  3.15 3.28 2.8 3.5 2.87 3.84 2.35 3.92 2.13 4.48 ...
 $ Cinema               : num  12.6 12.6 12.9 11.9 11.4 ...
 $ Wine                 : num  8.4 8.4 10.49 7.35 10.08 ...
 $ Gasoline             : num  1.32 1.31 1.28 1.25 0.97 0.65 0.99 1.57 1.15 1.68 ...
 $ Avg.Rent             : num  1714 2379 2608 1649 2083 ...
 $ Avg.Disposable.Income: num  4266 4198 3918 3848 3359 ...
NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Datatype of 'quality_of_life' dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Datatype of 'quality_of_life' dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(quality_of_life))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   216 obs. of  7 variables:
 $ City           : chr  "Caracas" "Johannesburg" "Fortaleza" "Saint Louis" ...
 $ Movehub.Rating : num  65.2 84.1 80.2 85.2 75.1 ...
 $ Purchase.Power : num  11.2 54 52.3 80.4 24.3 ...
 $ Health.Care    : num  44.4 60 45.5 77.3 61.8 ...
 $ Pollution      : num  83.5 47.4 66.3 31.3 18.9 ...
 $ Quality.of.Life: num  8.61 51.26 36.68 87.51 27.91 ...
 $ Crime.Rating   : num  85.7 83.9 78.7 78.1 77.9 ...
NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Datatype of 'cities' dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Datatype of 'cities' dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(cities))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3543 obs. of  4 variables:
 $ City   : chr  "Oakland" "Oakville" "Oaxaca de JuÃ¡rez" "Oberhausen" ...
 $ Country: chr  "United States" "Canada" "Mexico" "Germany" ...
 $ LAT    : chr  "37.7904" "43.45" "17.0606" "51.4967" ...
 $ LONG   : chr  "-122.2166" "-79.6833" "-96.7253" "6.8706" ...
NULL</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensuring city names are consistent across datasets </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cost_of_living<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">tolower</span>(cost_of_living<span class="sc">$</span>City)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>quality_of_life<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">tolower</span>(quality_of_life<span class="sc">$</span>City)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>cities<span class="sc">$</span>City <span class="ot">&lt;-</span> <span class="fu">tolower</span>(cities<span class="sc">$</span>City)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the dimensions of datasets </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Dimension of row-columns of 'cities' dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Dimension of row-columns of 'cities' dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(cities))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3543    4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Dimension of row-columns of 'cost of living' dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Dimension of row-columns of 'cost of living' dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(cost_of_living))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 216   7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Dimension of row-columns of 'quality of life' dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Dimension of row-columns of 'quality of life' dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(quality_of_life))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 216   7</code></pre>
</div>
</div>
</section>
<section id="merging-the-data-set-based-on-city" class="level3">
<h3 class="anchored" data-anchor-id="merging-the-data-set-based-on-city">Merging the data set based on City:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the datasets on the 'City' column </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> cost_of_living <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(quality_of_life, <span class="at">by =</span> <span class="st">"City"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(cities, <span class="at">by =</span> <span class="st">"City"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># displaying merged dataframe</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       City Cappuccino Cinema  Wine Gasoline Avg.Rent Avg.Disposable.Income
1  lausanne       3.15  12.59  8.40     1.32  1714.00               4266.11
2    geneva       2.80  12.94 10.49     1.28  2607.95               3917.72
3     basel       3.50  11.89  7.35     1.25  1649.29               3847.76
4     perth       2.87  11.43 10.08     0.97  2083.14               3358.55
5 nashville       3.84  12.00 13.50     0.65  2257.14               3089.75
6  canberra       2.35  11.42 10.08     0.99  1984.74               3023.91
  Movehub.Rating Purchase.Power Health.Care Pollution Quality.of.Life
1          87.21          90.77       65.85     87.62           73.21
2          83.27          61.22       74.88     29.43           82.76
3          84.20          78.17       79.74     59.18           88.27
4          95.38          62.11       80.56     23.53           74.62
5          80.61          80.30       60.30      0.00           80.50
6          83.23          63.26       91.90     11.48           93.05
  Crime.Rating       Country      LAT     LONG
1        35.55   Switzerland  46.5198   6.6335
2        54.36   Switzerland  46.2017   6.1469
3        28.12   Switzerland  47.5547   7.5906
4        50.01     Australia -31.9559 115.8606
5        25.50 United States  36.1715 -86.7842
6        40.36     Australia -35.2931 149.1269</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking merged dataframe datatype </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Datatype of 'combined_data' dataset:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Datatype of 'combined_data' dataset:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(combined_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   201 obs. of  16 variables:
 $ City                 : chr  "lausanne" "geneva" "basel" "perth" ...
 $ Cappuccino           : num  3.15 2.8 3.5 2.87 3.84 2.35 3.92 2.13 4.48 2.49 ...
 $ Cinema               : num  12.6 12.9 11.9 11.4 12 ...
 $ Wine                 : num  8.4 10.49 7.35 10.08 13.5 ...
 $ Gasoline             : num  1.32 1.28 1.25 0.97 0.65 0.99 1.57 1.15 1.68 0.95 ...
 $ Avg.Rent             : num  1714 2608 1649 2083 2257 ...
 $ Avg.Disposable.Income: num  4266 3918 3848 3359 3090 ...
 $ Movehub.Rating       : num  87.2 83.3 84.2 95.4 80.6 ...
 $ Purchase.Power       : num  90.8 61.2 78.2 62.1 80.3 ...
 $ Health.Care          : num  65.8 74.9 79.7 80.6 60.3 ...
 $ Pollution            : num  87.6 29.4 59.2 23.5 0 ...
 $ Quality.of.Life      : num  73.2 82.8 88.3 74.6 80.5 ...
 $ Crime.Rating         : num  35.5 54.4 28.1 50 25.5 ...
 $ Country              : chr  "Switzerland" "Switzerland" "Switzerland" "Australia" ...
 $ LAT                  : chr  "46.5198" "46.2017" "47.5547" "-31.9559" ...
 $ LONG                 : chr  "6.6335" "6.1469" "7.5906" "115.8606" ...
NULL</code></pre>
</div>
</div>
</section>
<section id="data-preprocessing" class="level3">
<h3 class="anchored" data-anchor-id="data-preprocessing">Data Preprocessing:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert LAT and LONG columns to numeric if they aren't already </span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>LAT <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(combined_data<span class="sc">$</span>LAT))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>combined_data<span class="sc">$</span>LONG <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(combined_data<span class="sc">$</span>LONG))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#checking the null value </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>combined_data[combined_data <span class="sc">==</span> <span class="st">"N/A"</span>]<span class="ot">&lt;-</span><span class="cn">NA</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(combined_data)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 City            Cappuccino                Cinema 
                    0                     0                     0 
                 Wine              Gasoline              Avg.Rent 
                    0                     0                     0 
Avg.Disposable.Income        Movehub.Rating        Purchase.Power 
                    0                     0                     0 
          Health.Care             Pollution       Quality.of.Life 
                    0                     0                     0 
         Crime.Rating               Country                   LAT 
                    0                     0                     0 
                 LONG 
                    0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define numerical and categorical columns </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>numerical_columns <span class="ot">&lt;-</span> <span class="fu">names</span>(combined_data)[<span class="fu">sapply</span>(combined_data, is.numeric)]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="ot">&lt;-</span> <span class="fu">names</span>(combined_data)[<span class="fu">sapply</span>(combined_data, <span class="cf">function</span>(x) <span class="fu">is.factor</span>(x) <span class="sc">|</span> <span class="fu">is.character</span>(x))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     City             Cappuccino        Cinema            Wine       
 Length:201         Min.   :0.460   Min.   : 1.810   Min.   : 2.130  
 Class :character   1st Qu.:1.310   1st Qu.: 4.270   1st Qu.: 4.260  
 Mode  :character   Median :2.040   Median : 6.820   Median : 6.530  
                    Mean   :1.966   Mean   : 6.829   Mean   : 7.103  
                    3rd Qu.:2.490   3rd Qu.: 7.970   3rd Qu.: 8.400  
                    Max.   :4.480   Max.   :79.490   Max.   :26.150  
    Gasoline        Avg.Rent      Avg.Disposable.Income Movehub.Rating  
 Min.   :0.070   Min.   : 120.7   Min.   : 120.7        Min.   : 59.88  
 1st Qu.:0.800   1st Qu.: 605.6   1st Qu.: 556.7        1st Qu.: 75.32  
 Median :1.000   Median : 980.6   Median :1460.5        Median : 80.85  
 Mean   :1.025   Mean   :1089.0   Mean   :1384.9        Mean   : 79.72  
 3rd Qu.:1.350   3rd Qu.:1382.3   3rd Qu.:2013.6        3rd Qu.: 83.55  
 Max.   :1.690   Max.   :5052.3   Max.   :4266.1        Max.   :100.00  
 Purchase.Power   Health.Care      Pollution     Quality.of.Life
 Min.   : 6.38   Min.   :20.83   Min.   : 0.00   Min.   : 5.29  
 1st Qu.:28.83   1st Qu.:58.90   1st Qu.:24.54   1st Qu.:42.65  
 Median :47.98   Median :67.88   Median :39.16   Median :62.82  
 Mean   :45.41   Mean   :66.31   Mean   :46.25   Mean   :58.76  
 3rd Qu.:58.77   3rd Qu.:77.31   3rd Qu.:68.21   3rd Qu.:77.07  
 Max.   :91.85   Max.   :95.96   Max.   :92.42   Max.   :93.05  
  Crime.Rating     Country               LAT              LONG        
 Min.   :10.86   Length:201         Min.   :-43.53   Min.   :-157.85  
 1st Qu.:28.91   Class :character   1st Qu.: 22.30   1st Qu.:  -9.15  
 Median :41.32   Mode  :character   Median : 40.40   Median :  10.00  
 Mean   :41.38                      Mean   : 30.38   Mean   :  10.50  
 3rd Qu.:50.38                      3rd Qu.: 48.78   3rd Qu.:  46.72  
 Max.   :85.70                      Max.   : 63.43   Max.   : 174.78  </code></pre>
</div>
</div>
</section>
<section id="exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis:</h3>
<section id="count-of-unique-values-in-each-categorical-column" class="level4">
<h4 class="anchored" data-anchor-id="count-of-unique-values-in-each-categorical-column">1. Count of Unique Values in Each Categorical Column:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count of Unique Values in Each Categorical Column</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>unique_counts <span class="ot">&lt;-</span> <span class="fu">sapply</span>(combined_data[<span class="fu">sapply</span>(combined_data, is.character)], <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the counts as a pie chart</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(unique_counts, <span class="at">main =</span> <span class="st">"Count of Unique Values in Each Categorical Column"</span>, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(unique_counts)),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">paste</span>(<span class="fu">names</span>(unique_counts), <span class="st">": "</span>, unique_counts), <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="wordcloud-of-country-cities-in-data-set" class="level4">
<h4 class="anchored" data-anchor-id="wordcloud-of-country-cities-in-data-set">2. Wordcloud of country &amp; cities in data set:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a corpus from the "Country" column</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>country_corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(combined_data<span class="sc">$</span>Country))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess the text for country names (remove punctuation, convert to lowercase, remove stopwords)</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  country_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(country_corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  country_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(country_corpus, removePunctuation)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  country_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(country_corpus, removeNumbers)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  country_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(country_corpus, removeWords, <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a custom function to remove empty documents from the corpus</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>removeEmptyDocs <span class="ot">&lt;-</span> <span class="cf">function</span>(corpus) {</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  empty_docs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(corpus, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="fu">as.character</span>(x), <span class="st">" "</span>)))) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(empty_docs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    corpus <span class="ot">&lt;-</span> corpus[<span class="sc">-</span>empty_docs]</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(corpus)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove empty documents from the corpus</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  country_corpus <span class="ot">&lt;-</span> <span class="fu">removeEmptyDocs</span>(country_corpus)</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert corpus to a plain text document</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>country_text <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(country_corpus, <span class="fu">content_transformer</span>(as.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(country_corpus,
content_transformer(as.character)): transformation drops documents</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate word cloud for countries with adjustments for long country names</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(country_text, <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order =</span> <span class="cn">FALSE</span>, <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">max.words =</span> <span class="dv">100</span>, <span class="at">scale=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a corpus from the "City" column</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>city_corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(combined_data<span class="sc">$</span>City))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess the text for city names (remove punctuation, convert to lowercase, remove stopwords)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  city_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(city_corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  city_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(city_corpus, removePunctuation)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  city_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(city_corpus, removeNumbers)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  city_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(city_corpus, removeWords, <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a custom function to remove empty documents from the corpus</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>removeEmptyDocs <span class="ot">&lt;-</span> <span class="cf">function</span>(corpus) {</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  empty_docs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(corpus, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="fu">as.character</span>(x), <span class="st">" "</span>)))) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(empty_docs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    corpus <span class="ot">&lt;-</span> corpus[<span class="sc">-</span>empty_docs]</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(corpus)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove empty documents from the corpus</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  city_corpus <span class="ot">&lt;-</span> <span class="fu">removeEmptyDocs</span>(city_corpus)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert corpus to a plain text document</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>city_text <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(city_corpus, <span class="fu">content_transformer</span>(as.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(city_corpus, content_transformer(as.character)):
transformation drops documents</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate word cloud for cities with adjustments for long city names</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(city_text, <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order =</span> <span class="cn">FALSE</span>, <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>), </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">max.words =</span> <span class="dv">50</span>, <span class="at">scale=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="histogram-of-distribution-of-numerical-columns" class="level4">
<h4 class="anchored" data-anchor-id="histogram-of-distribution-of-numerical-columns">3. Histogram of distribution of numerical columns:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each numerical column to create histograms</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(column_name <span class="cf">in</span> numerical_columns) {</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the name of the current column</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(column_name)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a symbol from the string column name</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  column_sym <span class="ot">&lt;-</span> <span class="fu">sym</span>(column_name)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot histogram for the current numerical column using tidy evaluation</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span>column_sym)) <span class="sc">+</span> </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Histogram of"</span>, column_name))</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This will actually draw the plot</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cappuccino"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cinema"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wine"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Gasoline"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Avg.Rent"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Avg.Disposable.Income"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Movehub.Rating"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Purchase.Power"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Health.Care"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pollution"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Quality.of.Life"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Crime.Rating"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LAT"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LONG"</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-17-14.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="are-there-any-significant-differences-in-cappuccino-prices-across-different-countries" class="level4">
<h4 class="anchored" data-anchor-id="are-there-any-significant-differences-in-cappuccino-prices-across-different-countries">4. Are there any significant differences in Cappuccino prices across different countries?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries by Cappuccino prices</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>top_10_countries <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Avg_Cappuccino_Price =</span> <span class="fu">mean</span>(Cappuccino)) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, Avg_Cappuccino_Price) <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Country)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">%in%</span> top_10_countries)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a boxplot to visualize the distribution of Cappuccino prices across the top 10 countries</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> Country, <span class="at">y =</span> Cappuccino)) <span class="sc">+</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Cappuccino Prices Across Top 10 Countries"</span>,</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cappuccino Price (USD)"</span>) <span class="sc">+</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA to test for significant differences in Cappuccino prices across the top 10 countries</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Cappuccino <span class="sc">~</span> Country, <span class="at">data =</span> filtered_data)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
Country      9  3.526  0.3917   3.657 0.0278 *
Residuals   10  1.071  0.1071                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="note-yes-there-are-significant-differences-in-cappuccino-prices-across-different-countries-according-to-the-anova-test-results." class="level5">
<h5 class="anchored" data-anchor-id="note-yes-there-are-significant-differences-in-cappuccino-prices-across-different-countries-according-to-the-anova-test-results.">Note: Yes, there are significant differences in Cappuccino prices across different countries according to the ANOVA test results.</h5>
</section>
</section>
<section id="geographical-distribution-of-top-10-cities-with-high-movehub-ratings" class="level4">
<h4 class="anchored" data-anchor-id="geographical-distribution-of-top-10-cities-with-high-movehub-ratings">5. Geographical distribution of top 10 cities with high Movehub Ratings:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order cities by Movehub Rating and select top 10</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>top_10_cities <span class="ot">&lt;-</span> combined_data[<span class="fu">order</span>(combined_data<span class="sc">$</span>Movehub.Rating, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Leaflet map</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(top_10_cities) <span class="sc">%&gt;%</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  <span class="co"># Add default OpenStreetMap map tiles</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>LONG, <span class="at">lat =</span> <span class="sc">~</span>LAT, </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="sc">~</span><span class="fu">sqrt</span>(Movehub.Rating) <span class="sc">*</span> <span class="dv">3</span>,  <span class="co"># Adjust circle marker size based on Movehub Rating</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#4CAF50"</span>, <span class="at">fillColor =</span> <span class="st">"#4CAF50"</span>, <span class="at">fillOpacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"&lt;b&gt;"</span>, City, <span class="st">"&lt;/b&gt;"</span>, <span class="st">"&lt;br&gt;"</span>, <span class="st">"&lt;b&gt;Movehub Rating:&lt;/b&gt; "</span>, Movehub.Rating)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldTopoMap) <span class="sc">%&gt;%</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addScaleBar</span>(<span class="at">position =</span> <span class="st">"bottomleft"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottomright"</span>,</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="st">"#4CAF50"</span>,</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="st">"Circle Radius (Movehub Rating)"</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addEasyButton</span>(<span class="fu">easyButton</span>(</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa-info-circle"</span>, <span class="at">title =</span> <span class="st">"Information"</span>,</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">onClick =</span> <span class="fu">JS</span>(<span class="st">"function(btn, map) { alert('This map displays the top 10 cities based on Movehub Rating, with circle markers representing Movehub Rating.'); }"</span>)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>m </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-b81a771f9bc2887c0e5d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b81a771f9bc2887c0e5d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[51.5072,42.983612,25.2631,48.8567,-31.9559,-33.8678,-37.8142,25.2867,40.6943,53.35],[-0.1275,-81.249725,55.2972,2.3522,115.8606,151.21,144.9631,51.5333,-73.92489999999999,-6.2603],[30,30,29.76508021154991,29.3816269120687,29.29880543639962,29.16796187600361,28.86555040181982,28.57568896807215,28.54417628869329,28.53156147146525],null,null,{"interactive":true,"className":"","stroke":true,"color":"#4CAF50","weight":5,"opacity":0.5,"fill":true,"fillColor":"#4CAF50","fillOpacity":0.7},null,null,["<b> london <\/b> <br> <b>Movehub Rating:<\/b>  100","<b> london <\/b> <br> <b>Movehub Rating:<\/b>  100","<b> dubai <\/b> <br> <b>Movehub Rating:<\/b>  98.44","<b> paris <\/b> <br> <b>Movehub Rating:<\/b>  95.92","<b> perth <\/b> <br> <b>Movehub Rating:<\/b>  95.38","<b> sydney <\/b> <br> <b>Movehub Rating:<\/b>  94.53","<b> melbourne <\/b> <br> <b>Movehub Rating:<\/b>  92.58","<b> doha <\/b> <br> <b>Movehub Rating:<\/b>  90.73","<b> new york <\/b> <br> <b>Movehub Rating:<\/b>  90.53","<b> dublin <\/b> <br> <b>Movehub Rating:<\/b>  90.45"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addLegend","args":[{"colors":["#4CAF50"],"labels":["Circle Radius (Movehub Rating)"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"unknown","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addEasyButton","args":[{"icon":"fa-info-circle","title":"Information","onClick":"function(btn, map) { alert('This map displays the top 10 cities based on Movehub Rating, with circle markers representing Movehub Rating.'); }","position":"topleft"}]}],"limits":{"lat":[-37.8142,53.35],"lng":[-81.249725,151.21]}},"evals":["calls.5.args.0.onClick"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="geographical-distribution-of-top-10-cities-with-quality.of.life" class="level4">
<h4 class="anchored" data-anchor-id="geographical-distribution-of-top-10-cities-with-quality.of.life">6. Geographical distribution of top 10 cities with Quality.of.Life:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order cities by Quality of Life and select top 10</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>top_10_cities <span class="ot">&lt;-</span> combined_data[<span class="fu">order</span>(combined_data<span class="sc">$</span>Quality.of.Life, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Leaflet map</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(top_10_cities) <span class="sc">%&gt;%</span> </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  <span class="co"># Add default OpenStreetMap map tiles</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>LONG, <span class="at">lat =</span> <span class="sc">~</span>LAT, </span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="sc">~</span><span class="fu">sqrt</span>(Quality.of.Life) <span class="sc">*</span> <span class="dv">3</span>,  <span class="co"># Adjust circle marker size based on Quality of Life</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#2196F3"</span>, <span class="at">fillColor =</span> <span class="st">"#2196F3"</span>, <span class="at">fillOpacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"&lt;b&gt;"</span>, City, <span class="st">"&lt;/b&gt;"</span>, <span class="st">"&lt;br&gt;"</span>, <span class="st">"&lt;b&gt;Quality of Life:&lt;/b&gt; "</span>, Quality.of.Life)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldTopoMap) <span class="sc">%&gt;%</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addScaleBar</span>(<span class="at">position =</span> <span class="st">"bottomleft"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottomright"</span>,</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="st">"#2196F3"</span>,</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="st">"Circle Radius (Quality of Life)"</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addEasyButton</span>(<span class="fu">easyButton</span>(</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa-info-circle"</span>, <span class="at">title =</span> <span class="st">"Information"</span>,</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">onClick =</span> <span class="fu">JS</span>(<span class="st">"function(btn, map) { alert('This map displays the top 10 cities based on Quality of Life, with circle markers representing Quality of Life.'); }"</span>)</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>m </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-55eaaf35d901fb635a7b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-55eaaf35d901fb635a7b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[-35.2931,-34.9275,52.52,50.7756,48.7775,51.05,48.1375,53.5344,47.5547,51.05],[149.1269,138.6,13.405,6.0836,9.18,13.74,11.575,-113.4903,7.5906,-114.0667],[28.93872837565604,28.70296151967598,28.64489483311119,28.54259974143911,28.52367437761131,28.49368351056072,28.47314524249121,28.39401345354333,28.18563463894329,28.073653128868],null,null,{"interactive":true,"className":"","stroke":true,"color":"#2196F3","weight":5,"opacity":0.5,"fill":true,"fillColor":"#2196F3","fillOpacity":0.7},null,null,["<b> canberra <\/b> <br> <b>Quality of Life:<\/b>  93.05","<b> adelaide <\/b> <br> <b>Quality of Life:<\/b>  91.54","<b> berlin <\/b> <br> <b>Quality of Life:<\/b>  91.17","<b> aachen <\/b> <br> <b>Quality of Life:<\/b>  90.52","<b> stuttgart <\/b> <br> <b>Quality of Life:<\/b>  90.4","<b> dresden <\/b> <br> <b>Quality of Life:<\/b>  90.21","<b> munich <\/b> <br> <b>Quality of Life:<\/b>  90.08","<b> edmonton <\/b> <br> <b>Quality of Life:<\/b>  89.58","<b> basel <\/b> <br> <b>Quality of Life:<\/b>  88.27","<b> calgary <\/b> <br> <b>Quality of Life:<\/b>  87.57"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addLegend","args":[{"colors":["#2196F3"],"labels":["Circle Radius (Quality of Life)"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"unknown","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addEasyButton","args":[{"icon":"fa-info-circle","title":"Information","onClick":"function(btn, map) { alert('This map displays the top 10 cities based on Quality of Life, with circle markers representing Quality of Life.'); }","position":"topleft"}]}],"limits":{"lat":[-35.2931,53.5344],"lng":[-114.0667,149.1269]}},"evals":["calls.5.args.0.onClick"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="geographical-distribution-of-top-10-cities-with-crime-rating" class="level4">
<h4 class="anchored" data-anchor-id="geographical-distribution-of-top-10-cities-with-crime-rating">7. Geographical distribution of top 10 cities with Crime Rating:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order cities by Crime Rating and select top 10</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>top_10_cities <span class="ot">&lt;-</span> combined_data[<span class="fu">order</span>(combined_data<span class="sc">$</span>Crime.Rating), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Leaflet map</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(top_10_cities) <span class="sc">%&gt;%</span> </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  <span class="co"># Add default OpenStreetMap map tiles</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>LONG, <span class="at">lat =</span> <span class="sc">~</span>LAT, </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="sc">~</span><span class="fu">sqrt</span>(Crime.Rating) <span class="sc">*</span> <span class="dv">3</span>,  <span class="co"># Adjust circle marker size based on Crime Rating</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#FF5722"</span>, <span class="at">fillColor =</span> <span class="st">"#FF5722"</span>, <span class="at">fillOpacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"&lt;b&gt;"</span>, City, <span class="st">"&lt;/b&gt;"</span>, <span class="st">"&lt;br&gt;"</span>, <span class="st">"&lt;b&gt;Crime Rating:&lt;/b&gt; "</span>, Crime.Rating)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldTopoMap) <span class="sc">%&gt;%</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addScaleBar</span>(<span class="at">position =</span> <span class="st">"bottomleft"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottomright"</span>,</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="st">"#FF5722"</span>,</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="st">"Circle Radius (Crime Rating)"</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addEasyButton</span>(<span class="fu">easyButton</span>(</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa-info-circle"</span>, <span class="at">title =</span> <span class="st">"Information"</span>,</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">onClick =</span> <span class="fu">JS</span>(<span class="st">"function(btn, map) { alert('This map displays the top 10 cities with the lowest Crime Rating, with circle markers representing Crime Rating.'); }"</span>)</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>m </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-19fe202a83100b3be60c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-19fe202a83100b3be60c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[24.4667,35.6897,51.05,48.1375,50.7756,25.0375,22.3,31.2286,60.3894,9.9312],[54.3667,139.6922,13.74,11.575,6.0836,121.5625,114.2,121.4747,5.33,76.26730000000001],[9.886354231970447,11.18883371938291,11.74989361653968,11.74989361653968,11.74989361653968,11.89075270956385,12.1156923037852,12.18974979234603,12.24867339755616,12.34382436686459],null,null,{"interactive":true,"className":"","stroke":true,"color":"#FF5722","weight":5,"opacity":0.5,"fill":true,"fillColor":"#FF5722","fillOpacity":0.7},null,null,["<b> abu dhabi <\/b> <br> <b>Crime Rating:<\/b>  10.86","<b> tokyo <\/b> <br> <b>Crime Rating:<\/b>  13.91","<b> dresden <\/b> <br> <b>Crime Rating:<\/b>  15.34","<b> munich <\/b> <br> <b>Crime Rating:<\/b>  15.34","<b> aachen <\/b> <br> <b>Crime Rating:<\/b>  15.34","<b> taipei <\/b> <br> <b>Crime Rating:<\/b>  15.71","<b> hong kong <\/b> <br> <b>Crime Rating:<\/b>  16.31","<b> shanghai <\/b> <br> <b>Crime Rating:<\/b>  16.51","<b> bergen <\/b> <br> <b>Crime Rating:<\/b>  16.67","<b> kochi <\/b> <br> <b>Crime Rating:<\/b>  16.93"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addLegend","args":[{"colors":["#FF5722"],"labels":["Circle Radius (Crime Rating)"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"unknown","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addEasyButton","args":[{"icon":"fa-info-circle","title":"Information","onClick":"function(btn, map) { alert('This map displays the top 10 cities with the lowest Crime Rating, with circle markers representing Crime Rating.'); }","position":"topleft"}]}],"limits":{"lat":[9.9312,60.3894],"lng":[5.33,139.6922]}},"evals":["calls.5.args.0.onClick"],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating new dataframe for Modelling: </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> combined_data[<span class="fu">complete.cases</span>(combined_data<span class="sc">$</span>LAT, combined_data<span class="sc">$</span>LONG), ] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="overall-correlation" class="level3">
<h3 class="anchored" data-anchor-id="overall-correlation">Overall correlation:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall correlation</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>num.cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(res, is.numeric)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>corrPLOT <span class="ot">&lt;-</span> <span class="fu">corrplot</span>(<span class="fu">cor</span>(res[,num.cols]), <span class="at">method=</span><span class="st">'ellipse'</span>, <span class="at">order=</span><span class="st">"AOE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Movehub Rating has negative correlation with Pollution, Crime as one can expect</li>
<li>Other features give a positive correlation with Movehub Rating</li>
</ul>
<section id="better-correlation" class="level4">
<h4 class="anchored" data-anchor-id="better-correlation">(better) Correlation:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (better) Correlation</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(res <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Quality.of.Life,<span class="sc">-</span>City,<span class="sc">-</span>Country))</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>num.cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(res, is.numeric)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>corrPLOT <span class="ot">&lt;-</span> <span class="fu">corrplot</span>(<span class="fu">cor</span>(res[,num.cols]), <span class="at">method=</span><span class="st">'number'</span>, <span class="at">order=</span><span class="st">"AOE"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>The higher correlated features with Movehub.Rating are Purchase.Power and `Avg.Disposable.Income</li>
<li>Gasoline does not show a strong correlation (to my surprise)</li>
<li>Cappuccino (I guess itâ€™s the average price) is almost as important as Health Care.</li>
</ul>
<p>Overall, there are linear correlations between Movehub Rating and the other numerical features. So we may try as a first test a linear model.</p>
</section>
</section>
<section id="applying-model-to-predict-movehub-rating-score" class="level3">
<h3 class="anchored" data-anchor-id="applying-model-to-predict-movehub-rating-score">APPLYING MODEL TO PREDICTâ€“&gt; Movehub Rating score :</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Test Split</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(res<span class="sc">$</span>Movehub.Rating, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">subset</span>(res, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">subset</span>(res, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot the result of a given model and other information</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>plotModel <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) {</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create dataframe with prediction and real values</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  mod.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, test)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  mod.res <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mod.predictions, test<span class="sc">$</span>Movehub.Rating)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(mod.res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Predictions'</span>, <span class="st">'True'</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  mod.res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mod.res)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make plots of residuals, etc.</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mod.res, <span class="fu">aes</span>(<span class="at">x =</span> Predictions, <span class="at">y =</span> True)) <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">50</span>, <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">50</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">'red'</span>)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mod.res, <span class="fu">aes</span>(<span class="at">x =</span> True <span class="sc">-</span> Predictions)) <span class="sc">+</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mod.res, <span class="fu">aes</span>(<span class="at">x =</span> Predictions, <span class="at">y =</span> True <span class="sc">-</span> Predictions)) <span class="sc">+</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrange the plots</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.arrange</span>(g1, g2, g3, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate metrics</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((mod.res<span class="sc">$</span>True <span class="sc">-</span> mod.res<span class="sc">$</span>Predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> mse<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>  SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((mod.res<span class="sc">$</span>Predictions <span class="sc">-</span> mod.res<span class="sc">$</span>True)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>  SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">mean</span>(test<span class="sc">$</span>Movehub.Rating) <span class="sc">-</span> mod.res<span class="sc">$</span>True)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSE <span class="sc">/</span> SST</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"MSE: %f RMSE : %f R^2 :%f"</span>, mse, rmse, R2)</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="linear-model-with-all-features" class="level4">
<h4 class="anchored" data-anchor-id="linear-model-with-all-features">-Linear model with all features:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying linear Regression</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>linModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(Movehub.Rating <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Movehub.Rating ~ ., data = train)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.7935 -1.4489 -0.2631  1.2780 14.4159 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           58.3390764  2.6577153  21.951  &lt; 2e-16 ***
Cappuccino            -0.2624010  0.5396183  -0.486  0.62761    
Cinema                 0.0206004  0.0449341   0.458  0.64741    
Wine                   0.1021572  0.1294251   0.789  0.43140    
Gasoline               2.9019739  1.0225435   2.838  0.00529 ** 
Avg.Rent               0.0023670  0.0005704   4.149 6.06e-05 ***
Avg.Disposable.Income -0.0016842  0.0007950  -2.119  0.03607 *  
Purchase.Power         0.3244978  0.0296638  10.939  &lt; 2e-16 ***
Health.Care            0.0313351  0.0203895   1.537  0.12682    
Pollution             -0.0040804  0.0118137  -0.345  0.73037    
Crime.Rating           0.0349714  0.0202210   1.729  0.08616 .  
LAT                   -0.0161790  0.0129305  -1.251  0.21315    
LONG                   0.0095956  0.0046706   2.054  0.04198 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.045 on 127 degrees of freedom
Multiple R-squared:  0.801, Adjusted R-squared:  0.7822 
F-statistic: 42.61 on 12 and 127 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the graph </span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotModel</span>(linModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>MSE: %f RMSE : %f R^2 :%f 17.39767 4.171052 0.6145516</code></pre>
</div>
</div>
</section>
<section id="linear-model-with-stepwise-regression" class="level4">
<h4 class="anchored" data-anchor-id="linear-model-with-stepwise-regression">-Linear model with stepwise regression:</h4>
<p>From the summary of the linear model, we see that not all the features are significant. So we can try to improve this linear model by performing a stepwise selection of features in both direction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear model with stepwise regression</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(linModel, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=324.18
Movehub.Rating ~ Cappuccino + Cinema + Wine + Gasoline + Avg.Rent + 
    Avg.Disposable.Income + Purchase.Power + Health.Care + Pollution + 
    Crime.Rating + LAT + LONG

                        Df Sum of Sq    RSS    AIC
- Pollution              1      1.11 1179.0 322.31
- Cinema                 1      1.95 1179.9 322.41
- Cappuccino             1      2.19 1180.1 322.44
- Wine                   1      5.78 1183.7 322.87
- LAT                    1     14.52 1192.4 323.90
&lt;none&gt;                               1177.9 324.18
- Health.Care            1     21.91 1199.8 324.76
- Crime.Rating           1     27.74 1205.7 325.44
- LONG                   1     39.15 1217.1 326.76
- Avg.Disposable.Income  1     41.63 1219.5 327.04
- Gasoline               1     74.70 1252.6 330.79
- Avg.Rent               1    159.70 1337.6 339.98
- Purchase.Power         1   1109.89 2287.8 415.12

Step:  AIC=322.31
Movehub.Rating ~ Cappuccino + Cinema + Wine + Gasoline + Avg.Rent + 
    Avg.Disposable.Income + Purchase.Power + Health.Care + Crime.Rating + 
    LAT + LONG

                        Df Sum of Sq    RSS    AIC
- Cappuccino             1      1.76 1180.8 320.52
- Cinema                 1      2.68 1181.7 320.63
- Wine                   1      5.99 1185.0 321.02
- LAT                    1     16.41 1195.4 322.25
&lt;none&gt;                               1179.0 322.31
- Health.Care            1     21.26 1200.3 322.81
- Crime.Rating           1     27.26 1206.3 323.51
+ Pollution              1      1.11 1177.9 324.18
- LONG                   1     38.71 1217.7 324.83
- Avg.Disposable.Income  1     43.59 1222.6 325.39
- Gasoline               1     90.60 1269.6 330.68
- Avg.Rent               1    166.71 1345.7 338.83
- Purchase.Power         1   1132.63 2311.7 414.57

Step:  AIC=320.52
Movehub.Rating ~ Cinema + Wine + Gasoline + Avg.Rent + Avg.Disposable.Income + 
    Purchase.Power + Health.Care + Crime.Rating + LAT + LONG

                        Df Sum of Sq    RSS    AIC
- Cinema                 1      2.92 1183.7 318.87
- Wine                   1      4.42 1185.2 319.04
&lt;none&gt;                               1180.8 320.52
- LAT                    1     19.59 1200.4 320.82
- Health.Care            1     21.29 1202.1 321.02
- Crime.Rating           1     26.81 1207.6 321.66
+ Cappuccino             1      1.76 1179.0 322.31
+ Pollution              1      0.67 1180.1 322.44
- LONG                   1     38.55 1219.3 323.02
- Avg.Disposable.Income  1     57.38 1238.2 325.16
- Gasoline               1     89.15 1269.9 328.71
- Avg.Rent               1    164.99 1345.8 336.83
- Purchase.Power         1   1161.98 2342.8 414.44

Step:  AIC=318.87
Movehub.Rating ~ Wine + Gasoline + Avg.Rent + Avg.Disposable.Income + 
    Purchase.Power + Health.Care + Crime.Rating + LAT + LONG

                        Df Sum of Sq    RSS    AIC
- Wine                   1      7.99 1191.7 317.81
&lt;none&gt;                               1183.7 318.87
- LAT                    1     18.29 1202.0 319.01
- Health.Care            1     20.92 1204.6 319.32
- Crime.Rating           1     27.58 1211.3 320.09
+ Cinema                 1      2.92 1180.8 320.52
+ Cappuccino             1      2.00 1181.7 320.63
+ Pollution              1      1.27 1182.4 320.72
- LONG                   1     40.95 1224.7 321.63
- Avg.Disposable.Income  1     55.73 1239.4 323.31
- Gasoline               1     88.80 1272.5 326.99
- Avg.Rent               1    162.06 1345.8 334.83
- Purchase.Power         1   1183.33 2367.0 413.88

Step:  AIC=317.81
Movehub.Rating ~ Gasoline + Avg.Rent + Avg.Disposable.Income + 
    Purchase.Power + Health.Care + Crime.Rating + LAT + LONG

                        Df Sum of Sq    RSS    AIC
&lt;none&gt;                               1191.7 317.81
- LAT                    1     20.02 1211.7 318.14
- Health.Care            1     21.71 1213.4 318.34
- Crime.Rating           1     23.06 1214.8 318.49
+ Wine                   1      7.99 1183.7 318.87
+ Cinema                 1      6.49 1185.2 319.04
+ Pollution              1      2.58 1189.1 319.51
+ Cappuccino             1      0.06 1191.6 319.80
- LONG                   1     43.24 1234.9 320.80
- Avg.Disposable.Income  1     48.09 1239.8 321.35
- Gasoline               1     84.26 1276.0 325.37
- Avg.Rent               1    188.27 1380.0 336.34
- Purchase.Power         1   1214.75 2406.4 414.20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>step<span class="sc">$</span>anova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Model Path 
Analysis of Deviance Table

Initial Model:
Movehub.Rating ~ Cappuccino + Cinema + Wine + Gasoline + Avg.Rent + 
    Avg.Disposable.Income + Purchase.Power + Health.Care + Pollution + 
    Crime.Rating + LAT + LONG

Final Model:
Movehub.Rating ~ Gasoline + Avg.Rent + Avg.Disposable.Income + 
    Purchase.Power + Health.Care + Crime.Rating + LAT + LONG

          Step Df Deviance Resid. Df Resid. Dev      AIC
1                                127   1177.913 324.1800
2  - Pollution  1 1.106496       128   1179.020 322.3115
3 - Cappuccino  1 1.758833       129   1180.779 320.5202
4     - Cinema  1 2.924060       130   1183.703 318.8665
5       - Wine  1 7.988275       131   1191.691 317.8081</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>finalModel <span class="ot">&lt;-</span> <span class="fu">lm</span>(Movehub.Rating <span class="sc">~</span> Cappuccino <span class="sc">+</span> Gasoline <span class="sc">+</span> Avg.Rent <span class="sc">+</span> Purchase.Power <span class="sc">+</span> Health.Care, <span class="at">data =</span> train)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(finalModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Movehub.Rating ~ Cappuccino + Gasoline + Avg.Rent + 
    Purchase.Power + Health.Care, data = train)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.2675 -1.8157 -0.3025  1.5552 14.7603 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    63.4341660  1.3299976  47.695  &lt; 2e-16 ***
Cappuccino     -0.6709330  0.4581963  -1.464   0.1455    
Gasoline        1.4177586  0.7911495   1.792   0.0754 .  
Avg.Rent        0.0022600  0.0004962   4.554 1.17e-05 ***
Purchase.Power  0.2552946  0.0171398  14.895  &lt; 2e-16 ***
Health.Care     0.0296582  0.0206849   1.434   0.1540    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.194 on 134 degrees of freedom
Multiple R-squared:  0.7691,    Adjusted R-squared:  0.7605 
F-statistic: 89.26 on 5 and 134 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the graph of residuals for the final model</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotModel</span>(finalModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment3_23174917_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>MSE: %f RMSE : %f R^2 :%f 15.75842 3.969687 0.6508697</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison between all features and selected ones</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(linModel, finalModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Movehub.Rating ~ Cappuccino + Cinema + Wine + Gasoline + Avg.Rent + 
    Avg.Disposable.Income + Purchase.Power + Health.Care + Pollution + 
    Crime.Rating + LAT + LONG
Model 2: Movehub.Rating ~ Cappuccino + Gasoline + Avg.Rent + Purchase.Power + 
    Health.Care
  Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
1    127 1177.9                                
2    134 1367.1 -7   -189.22 2.9144 0.007341 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="note-the-model-found-with-the-stepwise-regression-did-achieve-a-better-r2-score-0.6508697-vs.-0.6145516" class="level5">
<h5 class="anchored" data-anchor-id="note-the-model-found-with-the-stepwise-regression-did-achieve-a-better-r2-score-0.6508697-vs.-0.6145516">Note: The model found with the stepwise regression did achieve a better R^2 score (0.6508697 vs.&nbsp;0.6145516)</h5>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>